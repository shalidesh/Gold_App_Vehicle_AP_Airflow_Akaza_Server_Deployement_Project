[2024-10-21T10:25:43.023+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Vehicle_Data_scrape_Pipeline.scrape_vehicle_info_from_link manual__2024-10-21T10:19:34.643139+00:00 [queued]>
[2024-10-21T10:25:43.030+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Vehicle_Data_scrape_Pipeline.scrape_vehicle_info_from_link manual__2024-10-21T10:19:34.643139+00:00 [queued]>
[2024-10-21T10:25:43.036+0000] {taskinstance.py:2193} INFO - Starting attempt 2 of 4
[2024-10-21T10:25:43.051+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): scrape_vehicle_info_from_link> on 2024-10-21 10:19:34.643139+00:00
[2024-10-21T10:25:43.059+0000] {standard_task_runner.py:60} INFO - Started process 30820 to run task
[2024-10-21T10:25:43.061+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'Vehicle_Data_scrape_Pipeline', 'scrape_vehicle_info_from_link', 'manual__2024-10-21T10:19:34.643139+00:00', '--job-id', '128', '--raw', '--subdir', 'DAGS_FOLDER/vehicle_data_scraping_pipeline.py', '--cfg-path', '/tmp/tmp5mwk27lx']
[2024-10-21T10:25:43.073+0000] {standard_task_runner.py:88} INFO - Job 128: Subtask scrape_vehicle_info_from_link
[2024-10-21T10:25:43.186+0000] {task_command.py:423} INFO - Running <TaskInstance: Vehicle_Data_scrape_Pipeline.scrape_vehicle_info_from_link manual__2024-10-21T10:19:34.643139+00:00 [running]> on host 988c1a0779ad
[2024-10-21T10:25:43.225+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='sdeshan' AIRFLOW_CTX_DAG_ID='Vehicle_Data_scrape_Pipeline' AIRFLOW_CTX_TASK_ID='scrape_vehicle_info_from_link' AIRFLOW_CTX_EXECUTION_DATE='2024-10-21T10:19:34.643139+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-10-21T10:19:34.643139+00:00'
[2024-10-21T10:25:43.232+0000] {logging_mixin.py:188} WARNING -   0%|          | 0/68 [00:00<?, ?it/s]
[2024-10-21T10:25:47.052+0000] {logging_mixin.py:188} WARNING -   1%|1         | 1/68 [00:03<04:15,  3.82s/it]
[2024-10-21T10:25:52.130+0000] {logging_mixin.py:188} WARNING -   3%|2         | 2/68 [00:08<05:00,  4.56s/it]
[2024-10-21T10:25:56.060+0000] {logging_mixin.py:188} WARNING -   4%|4         | 3/68 [00:12<04:37,  4.27s/it]
[2024-10-21T10:25:59.195+0000] {logging_mixin.py:188} WARNING -   6%|5         | 4/68 [00:15<04:04,  3.82s/it]
[2024-10-21T10:26:02.991+0000] {logging_mixin.py:188} WARNING -   7%|7         | 5/68 [00:19<04:00,  3.81s/it]
[2024-10-21T10:26:06.411+0000] {logging_mixin.py:188} WARNING -   9%|8         | 6/68 [00:23<03:48,  3.68s/it]
[2024-10-21T10:26:11.052+0000] {logging_mixin.py:188} WARNING -  10%|#         | 7/68 [00:27<04:03,  3.99s/it]
[2024-10-21T10:26:14.762+0000] {logging_mixin.py:188} WARNING -  12%|#1        | 8/68 [00:31<03:54,  3.90s/it]
[2024-10-21T10:26:18.168+0000] {logging_mixin.py:188} WARNING -  13%|#3        | 9/68 [00:34<03:41,  3.75s/it]
[2024-10-21T10:26:52.834+0000] {logging_mixin.py:188} WARNING -  15%|#4        | 10/68 [01:09<12:51, 13.29s/it]
[2024-10-21T10:27:02.463+0000] {logging_mixin.py:188} WARNING -  16%|#6        | 11/68 [01:19<11:33, 12.17s/it]
[2024-10-21T10:27:06.461+0000] {logging_mixin.py:188} WARNING -  18%|#7        | 12/68 [01:23<09:02,  9.69s/it]
[2024-10-21T10:27:10.565+0000] {logging_mixin.py:188} WARNING -  19%|#9        | 13/68 [01:27<07:19,  7.99s/it]
[2024-10-21T10:27:15.127+0000] {logging_mixin.py:188} WARNING -  21%|##        | 14/68 [01:31<06:15,  6.96s/it]
[2024-10-21T10:27:19.448+0000] {logging_mixin.py:188} WARNING -  22%|##2       | 15/68 [01:36<05:26,  6.16s/it]
[2024-10-21T10:27:24.743+0000] {logging_mixin.py:188} WARNING -  24%|##3       | 16/68 [01:41<05:06,  5.90s/it]
[2024-10-21T10:27:28.233+0000] {logging_mixin.py:188} WARNING -  25%|##5       | 17/68 [01:45<04:23,  5.18s/it]
[2024-10-21T10:27:32.247+0000] {logging_mixin.py:188} WARNING -  26%|##6       | 18/68 [01:49<04:01,  4.83s/it]
[2024-10-21T10:27:37.042+0000] {logging_mixin.py:188} WARNING -  28%|##7       | 19/68 [01:53<03:56,  4.82s/it]
[2024-10-21T10:27:40.634+0000] {logging_mixin.py:188} WARNING -  29%|##9       | 20/68 [01:57<03:33,  4.45s/it]
[2024-10-21T10:27:44.268+0000] {logging_mixin.py:188} WARNING -  31%|###       | 21/68 [02:01<03:17,  4.20s/it]
[2024-10-21T10:27:48.239+0000] {logging_mixin.py:188} WARNING -  32%|###2      | 22/68 [02:05<03:10,  4.13s/it]
[2024-10-21T10:27:51.968+0000] {logging_mixin.py:188} WARNING -  34%|###3      | 23/68 [02:08<03:00,  4.01s/it]
[2024-10-21T10:27:55.920+0000] {logging_mixin.py:188} WARNING -  35%|###5      | 24/68 [02:12<02:55,  3.99s/it]
[2024-10-21T10:27:59.829+0000] {logging_mixin.py:188} WARNING -  37%|###6      | 25/68 [02:16<02:50,  3.97s/it]
[2024-10-21T10:28:04.032+0000] {logging_mixin.py:188} WARNING -  38%|###8      | 26/68 [02:20<02:49,  4.04s/it]
[2024-10-21T10:28:10.159+0000] {logging_mixin.py:188} WARNING -  40%|###9      | 27/68 [02:26<03:11,  4.67s/it]
[2024-10-21T10:28:14.442+0000] {logging_mixin.py:188} WARNING -  41%|####1     | 28/68 [02:31<03:02,  4.55s/it]
[2024-10-21T10:28:18.159+0000] {logging_mixin.py:188} WARNING -  43%|####2     | 29/68 [02:34<02:47,  4.30s/it]
[2024-10-21T10:28:23.624+0000] {logging_mixin.py:188} WARNING -  44%|####4     | 30/68 [02:40<02:56,  4.65s/it]
[2024-10-21T10:28:27.067+0000] {logging_mixin.py:188} WARNING -  46%|####5     | 31/68 [02:43<02:38,  4.29s/it]
[2024-10-21T10:28:30.522+0000] {logging_mixin.py:188} WARNING -  47%|####7     | 32/68 [02:47<02:25,  4.04s/it]
[2024-10-21T10:28:34.406+0000] {logging_mixin.py:188} WARNING -  49%|####8     | 33/68 [02:51<02:19,  3.99s/it]
[2024-10-21T10:28:42.542+0000] {logging_mixin.py:188} WARNING -  50%|#####     | 34/68 [02:59<02:57,  5.24s/it]
[2024-10-21T10:28:48.883+0000] {logging_mixin.py:188} WARNING -  51%|#####1    | 35/68 [03:05<03:03,  5.57s/it]
[2024-10-21T10:28:54.799+0000] {logging_mixin.py:188} WARNING -  53%|#####2    | 36/68 [03:11<03:01,  5.67s/it]
[2024-10-21T10:28:59.191+0000] {logging_mixin.py:188} WARNING -  54%|#####4    | 37/68 [03:15<02:43,  5.29s/it]
[2024-10-21T10:29:03.642+0000] {logging_mixin.py:188} WARNING -  56%|#####5    | 38/68 [03:20<02:31,  5.04s/it]
[2024-10-21T10:29:07.123+0000] {logging_mixin.py:188} WARNING -  57%|#####7    | 39/68 [03:23<02:12,  4.57s/it]
[2024-10-21T10:29:12.268+0000] {logging_mixin.py:188} WARNING -  59%|#####8    | 40/68 [03:29<02:12,  4.74s/it]
[2024-10-21T10:29:15.945+0000] {logging_mixin.py:188} WARNING -  60%|######    | 41/68 [03:32<01:59,  4.42s/it]
[2024-10-21T10:29:19.529+0000] {logging_mixin.py:188} WARNING -  62%|######1   | 42/68 [03:36<01:48,  4.17s/it]
[2024-10-21T10:29:22.983+0000] {logging_mixin.py:188} WARNING -  63%|######3   | 43/68 [03:39<01:38,  3.96s/it]
[2024-10-21T10:29:26.855+0000] {logging_mixin.py:188} WARNING -  65%|######4   | 44/68 [03:43<01:34,  3.93s/it]
[2024-10-21T10:29:31.221+0000] {logging_mixin.py:188} WARNING -  66%|######6   | 45/68 [03:47<01:33,  4.06s/it]
[2024-10-21T10:29:36.118+0000] {logging_mixin.py:188} WARNING -  68%|######7   | 46/68 [03:52<01:34,  4.31s/it]
[2024-10-21T10:29:40.340+0000] {logging_mixin.py:188} WARNING -  69%|######9   | 47/68 [03:57<01:29,  4.28s/it]
[2024-10-21T10:29:44.363+0000] {logging_mixin.py:188} WARNING -  71%|#######   | 48/68 [04:01<01:24,  4.21s/it]
[2024-10-21T10:29:48.879+0000] {logging_mixin.py:188} WARNING -  72%|#######2  | 49/68 [04:05<01:21,  4.30s/it]
[2024-10-21T10:29:52.758+0000] {logging_mixin.py:188} WARNING -  74%|#######3  | 50/68 [04:09<01:15,  4.17s/it]
[2024-10-21T10:30:00.758+0000] {logging_mixin.py:188} WARNING -  75%|#######5  | 51/68 [04:17<01:30,  5.32s/it]
[2024-10-21T10:30:05.593+0000] {logging_mixin.py:188} WARNING -  76%|#######6  | 52/68 [04:22<01:22,  5.18s/it]
[2024-10-21T10:30:09.588+0000] {logging_mixin.py:188} WARNING -  78%|#######7  | 53/68 [04:26<01:12,  4.82s/it]
[2024-10-21T10:30:13.276+0000] {logging_mixin.py:188} WARNING -  79%|#######9  | 54/68 [04:30<01:02,  4.48s/it]
[2024-10-21T10:30:17.342+0000] {logging_mixin.py:188} WARNING -  81%|########  | 55/68 [04:34<00:56,  4.36s/it]
[2024-10-21T10:30:20.619+0000] {logging_mixin.py:188} WARNING -  82%|########2 | 56/68 [04:37<00:48,  4.03s/it]
[2024-10-21T10:30:24.742+0000] {logging_mixin.py:188} WARNING -  84%|########3 | 57/68 [04:41<00:44,  4.06s/it]
[2024-10-21T10:30:28.180+0000] {logging_mixin.py:188} WARNING -  85%|########5 | 58/68 [04:44<00:38,  3.87s/it]
[2024-10-21T10:30:31.403+0000] {logging_mixin.py:188} WARNING -  87%|########6 | 59/68 [04:48<00:33,  3.68s/it]
[2024-10-21T10:30:35.152+0000] {logging_mixin.py:188} WARNING -  88%|########8 | 60/68 [04:51<00:29,  3.70s/it]
[2024-10-21T10:30:38.680+0000] {logging_mixin.py:188} WARNING -  90%|########9 | 61/68 [04:55<00:25,  3.65s/it]
[2024-10-21T10:30:42.130+0000] {logging_mixin.py:188} WARNING -  91%|#########1| 62/68 [04:58<00:21,  3.59s/it]
[2024-10-21T10:30:45.542+0000] {logging_mixin.py:188} WARNING -  93%|#########2| 63/68 [05:02<00:17,  3.54s/it]
[2024-10-21T10:30:49.356+0000] {logging_mixin.py:188} WARNING -  94%|#########4| 64/68 [05:06<00:14,  3.62s/it]
[2024-10-21T10:30:53.030+0000] {logging_mixin.py:188} WARNING -  96%|#########5| 65/68 [05:09<00:10,  3.64s/it]
[2024-10-21T10:30:56.909+0000] {logging_mixin.py:188} WARNING -  97%|#########7| 66/68 [05:13<00:07,  3.71s/it]
[2024-10-21T10:31:01.729+0000] {logging_mixin.py:188} WARNING -  99%|#########8| 67/68 [05:18<00:04,  4.04s/it]
[2024-10-21T10:31:05.475+0000] {logging_mixin.py:188} WARNING - 100%|##########| 68/68 [05:22<00:00,  3.95s/it]
[2024-10-21T10:31:05.476+0000] {logging_mixin.py:188} WARNING - 100%|##########| 68/68 [05:22<00:00,  4.74s/it]
[2024-10-21T10:31:05.498+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/components/vehicle/data_scraping_components/post_data_extraction.py", line 153, in scarpe_and_save
    upload_table_vehicle(data_table)
  File "/opt/airflow/dags/components/utils/database_table_creation.py", line 35, in upload_table_vehicle
    cur.execute(f"""
psycopg2.errors.InsufficientPrivilege: could not open file "/var/lib/postgresql/vehicle/ikman_post_data.csv" for writing: Permission denied
HINT:  COPY TO instructs the PostgreSQL server process to write a file. You may want a client-side facility such as psql's \copy.

[2024-10-21T10:31:05.539+0000] {taskinstance.py:1149} INFO - Marking task as UP_FOR_RETRY. dag_id=Vehicle_Data_scrape_Pipeline, task_id=scrape_vehicle_info_from_link, execution_date=20241021T101934, start_date=20241021T102543, end_date=20241021T103105
[2024-10-21T10:31:05.548+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 128 for task scrape_vehicle_info_from_link (could not open file "/var/lib/postgresql/vehicle/ikman_post_data.csv" for writing: Permission denied
HINT:  COPY TO instructs the PostgreSQL server process to write a file. You may want a client-side facility such as psql's \copy.
; 30820)
[2024-10-21T10:31:05.561+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-10-21T10:31:05.573+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
