[2024-10-21T10:31:12.097+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Vehicle_Data_scrape_Pipeline.scrape_vehicle_info_from_link manual__2024-10-21T10:19:34.643139+00:00 [queued]>
[2024-10-21T10:31:12.102+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Vehicle_Data_scrape_Pipeline.scrape_vehicle_info_from_link manual__2024-10-21T10:19:34.643139+00:00 [queued]>
[2024-10-21T10:31:12.162+0000] {taskinstance.py:2193} INFO - Starting attempt 3 of 4
[2024-10-21T10:31:12.241+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): scrape_vehicle_info_from_link> on 2024-10-21 10:19:34.643139+00:00
[2024-10-21T10:31:12.246+0000] {standard_task_runner.py:60} INFO - Started process 31601 to run task
[2024-10-21T10:31:12.249+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'Vehicle_Data_scrape_Pipeline', 'scrape_vehicle_info_from_link', 'manual__2024-10-21T10:19:34.643139+00:00', '--job-id', '129', '--raw', '--subdir', 'DAGS_FOLDER/vehicle_data_scraping_pipeline.py', '--cfg-path', '/tmp/tmp7hjlyvnb']
[2024-10-21T10:31:12.251+0000] {standard_task_runner.py:88} INFO - Job 129: Subtask scrape_vehicle_info_from_link
[2024-10-21T10:31:12.374+0000] {task_command.py:423} INFO - Running <TaskInstance: Vehicle_Data_scrape_Pipeline.scrape_vehicle_info_from_link manual__2024-10-21T10:19:34.643139+00:00 [running]> on host 988c1a0779ad
[2024-10-21T10:31:12.416+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='sdeshan' AIRFLOW_CTX_DAG_ID='Vehicle_Data_scrape_Pipeline' AIRFLOW_CTX_TASK_ID='scrape_vehicle_info_from_link' AIRFLOW_CTX_EXECUTION_DATE='2024-10-21T10:19:34.643139+00:00' AIRFLOW_CTX_TRY_NUMBER='3' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-10-21T10:19:34.643139+00:00'
[2024-10-21T10:31:12.422+0000] {logging_mixin.py:188} WARNING -   0%|          | 0/68 [00:00<?, ?it/s]
[2024-10-21T10:31:19.385+0000] {logging_mixin.py:188} WARNING -   1%|1         | 1/68 [00:06<07:46,  6.96s/it]
[2024-10-21T10:31:26.883+0000] {logging_mixin.py:188} WARNING -   3%|2         | 2/68 [00:14<08:00,  7.28s/it]
[2024-10-21T10:31:30.570+0000] {logging_mixin.py:188} WARNING -   4%|4         | 3/68 [00:18<06:06,  5.64s/it]
[2024-10-21T10:31:34.155+0000] {logging_mixin.py:188} WARNING -   6%|5         | 4/68 [00:21<05:08,  4.83s/it]
[2024-10-21T10:31:38.469+0000] {logging_mixin.py:188} WARNING -   7%|7         | 5/68 [00:26<04:52,  4.64s/it]
[2024-10-21T10:31:42.650+0000] {logging_mixin.py:188} WARNING -   9%|8         | 6/68 [00:30<04:38,  4.49s/it]
[2024-10-21T10:31:46.967+0000] {logging_mixin.py:188} WARNING -  10%|#         | 7/68 [00:34<04:30,  4.43s/it]
[2024-10-21T10:31:50.535+0000] {logging_mixin.py:188} WARNING -  12%|#1        | 8/68 [00:38<04:09,  4.16s/it]
[2024-10-21T10:31:54.406+0000] {logging_mixin.py:188} WARNING -  13%|#3        | 9/68 [00:41<03:59,  4.07s/it]
[2024-10-21T10:31:58.547+0000] {logging_mixin.py:188} WARNING -  15%|#4        | 10/68 [00:46<03:57,  4.09s/it]
[2024-10-21T10:32:01.891+0000] {logging_mixin.py:188} WARNING -  16%|#6        | 11/68 [00:49<03:40,  3.86s/it]
[2024-10-21T10:32:06.348+0000] {logging_mixin.py:188} WARNING -  18%|#7        | 12/68 [00:53<03:46,  4.04s/it]
[2024-10-21T10:32:10.496+0000] {logging_mixin.py:188} WARNING -  19%|#9        | 13/68 [00:58<03:44,  4.07s/it]
[2024-10-21T10:32:15.642+0000] {logging_mixin.py:188} WARNING -  21%|##        | 14/68 [01:03<03:57,  4.40s/it]
[2024-10-21T10:32:19.121+0000] {logging_mixin.py:188} WARNING -  22%|##2       | 15/68 [01:06<03:38,  4.12s/it]
[2024-10-21T10:32:23.132+0000] {logging_mixin.py:188} WARNING -  24%|##3       | 16/68 [01:10<03:32,  4.09s/it]
[2024-10-21T10:32:26.708+0000] {logging_mixin.py:188} WARNING -  25%|##5       | 17/68 [01:14<03:20,  3.93s/it]
[2024-10-21T10:32:30.278+0000] {logging_mixin.py:188} WARNING -  26%|##6       | 18/68 [01:17<03:11,  3.82s/it]
[2024-10-21T10:32:34.077+0000] {logging_mixin.py:188} WARNING -  28%|##7       | 19/68 [01:21<03:07,  3.82s/it]
[2024-10-21T10:32:37.765+0000] {logging_mixin.py:188} WARNING -  29%|##9       | 20/68 [01:25<03:01,  3.78s/it]
[2024-10-21T10:32:41.679+0000] {logging_mixin.py:188} WARNING -  31%|###       | 21/68 [01:29<02:59,  3.82s/it]
[2024-10-21T10:32:45.776+0000] {logging_mixin.py:188} WARNING -  32%|###2      | 22/68 [01:33<02:59,  3.90s/it]
[2024-10-21T10:32:49.626+0000] {logging_mixin.py:188} WARNING -  34%|###3      | 23/68 [01:37<02:54,  3.89s/it]
[2024-10-21T10:32:53.900+0000] {logging_mixin.py:188} WARNING -  35%|###5      | 24/68 [01:41<02:56,  4.00s/it]
[2024-10-21T10:32:57.754+0000] {logging_mixin.py:188} WARNING -  37%|###6      | 25/68 [01:45<02:50,  3.96s/it]
[2024-10-21T10:33:01.336+0000] {logging_mixin.py:188} WARNING -  38%|###8      | 26/68 [01:48<02:41,  3.85s/it]
[2024-10-21T10:33:05.908+0000] {logging_mixin.py:188} WARNING -  40%|###9      | 27/68 [01:53<02:46,  4.06s/it]
[2024-10-21T10:33:09.836+0000] {logging_mixin.py:188} WARNING -  41%|####1     | 28/68 [01:57<02:40,  4.02s/it]
[2024-10-21T10:33:13.870+0000] {logging_mixin.py:188} WARNING -  43%|####2     | 29/68 [02:01<02:37,  4.03s/it]
[2024-10-21T10:33:19.171+0000] {logging_mixin.py:188} WARNING -  44%|####4     | 30/68 [02:06<02:47,  4.41s/it]
[2024-10-21T10:33:24.242+0000] {logging_mixin.py:188} WARNING -  46%|####5     | 31/68 [02:11<02:50,  4.61s/it]
[2024-10-21T10:33:28.501+0000] {logging_mixin.py:188} WARNING -  47%|####7     | 32/68 [02:16<02:42,  4.50s/it]
[2024-10-21T10:33:33.420+0000] {logging_mixin.py:188} WARNING -  49%|####8     | 33/68 [02:20<02:41,  4.63s/it]
[2024-10-21T10:33:37.545+0000] {logging_mixin.py:188} WARNING -  50%|#####     | 34/68 [02:25<02:32,  4.48s/it]
[2024-10-21T10:33:41.527+0000] {logging_mixin.py:188} WARNING -  51%|#####1    | 35/68 [02:29<02:22,  4.33s/it]
[2024-10-21T10:33:45.362+0000] {logging_mixin.py:188} WARNING -  53%|#####2    | 36/68 [02:32<02:13,  4.18s/it]
[2024-10-21T10:33:48.750+0000] {logging_mixin.py:188} WARNING -  54%|#####4    | 37/68 [02:36<02:02,  3.94s/it]
[2024-10-21T10:33:52.707+0000] {logging_mixin.py:188} WARNING -  56%|#####5    | 38/68 [02:40<01:58,  3.95s/it]
[2024-10-21T10:33:56.228+0000] {logging_mixin.py:188} WARNING -  57%|#####7    | 39/68 [02:43<01:50,  3.82s/it]
[2024-10-21T10:34:01.204+0000] {logging_mixin.py:188} WARNING -  59%|#####8    | 40/68 [02:48<01:56,  4.17s/it]
[2024-10-21T10:34:05.164+0000] {logging_mixin.py:188} WARNING -  60%|######    | 41/68 [02:52<01:50,  4.10s/it]
[2024-10-21T10:34:08.736+0000] {logging_mixin.py:188} WARNING -  62%|######1   | 42/68 [02:56<01:42,  3.94s/it]
[2024-10-21T10:34:12.026+0000] {logging_mixin.py:188} WARNING -  63%|######3   | 43/68 [02:59<01:33,  3.75s/it]
[2024-10-21T10:34:15.528+0000] {logging_mixin.py:188} WARNING -  65%|######4   | 44/68 [03:03<01:28,  3.67s/it]
[2024-10-21T10:34:18.797+0000] {logging_mixin.py:188} WARNING -  66%|######6   | 45/68 [03:06<01:21,  3.55s/it]
[2024-10-21T10:34:22.747+0000] {logging_mixin.py:188} WARNING -  68%|######7   | 46/68 [03:10<01:20,  3.67s/it]
[2024-10-21T10:34:26.344+0000] {logging_mixin.py:188} WARNING -  69%|######9   | 47/68 [03:13<01:16,  3.65s/it]
[2024-10-21T10:34:29.837+0000] {logging_mixin.py:188} WARNING -  71%|#######   | 48/68 [03:17<01:12,  3.60s/it]
[2024-10-21T10:34:36.610+0000] {logging_mixin.py:188} WARNING -  72%|#######2  | 49/68 [03:24<01:26,  4.55s/it]
[2024-10-21T10:34:40.793+0000] {logging_mixin.py:188} WARNING -  74%|#######3  | 50/68 [03:28<01:19,  4.44s/it]
[2024-10-21T10:34:47.911+0000] {logging_mixin.py:188} WARNING -  75%|#######5  | 51/68 [03:35<01:29,  5.25s/it]
[2024-10-21T10:34:52.114+0000] {logging_mixin.py:188} WARNING -  76%|#######6  | 52/68 [03:39<01:18,  4.93s/it]
[2024-10-21T10:34:55.917+0000] {logging_mixin.py:188} WARNING -  78%|#######7  | 53/68 [03:43<01:08,  4.59s/it]
[2024-10-21T10:35:00.090+0000] {logging_mixin.py:188} WARNING -  79%|#######9  | 54/68 [03:47<01:02,  4.47s/it]
[2024-10-21T10:35:03.827+0000] {logging_mixin.py:188} WARNING -  81%|########  | 55/68 [03:51<00:55,  4.25s/it]
[2024-10-21T10:35:07.783+0000] {logging_mixin.py:188} WARNING -  82%|########2 | 56/68 [03:55<00:49,  4.16s/it]
[2024-10-21T10:35:11.676+0000] {logging_mixin.py:188} WARNING -  84%|########3 | 57/68 [03:59<00:44,  4.08s/it]
[2024-10-21T10:35:15.073+0000] {logging_mixin.py:188} WARNING -  85%|########5 | 58/68 [04:02<00:38,  3.88s/it]
[2024-10-21T10:35:19.094+0000] {logging_mixin.py:188} WARNING -  87%|########6 | 59/68 [04:06<00:35,  3.92s/it]
[2024-10-21T10:35:23.314+0000] {logging_mixin.py:188} WARNING -  88%|########8 | 60/68 [04:10<00:32,  4.01s/it]
[2024-10-21T10:35:27.216+0000] {logging_mixin.py:188} WARNING -  90%|########9 | 61/68 [04:14<00:27,  3.98s/it]
[2024-10-21T10:35:31.215+0000] {logging_mixin.py:188} WARNING -  91%|#########1| 62/68 [04:18<00:23,  3.98s/it]
[2024-10-21T10:35:36.034+0000] {logging_mixin.py:188} WARNING -  93%|#########2| 63/68 [04:23<00:21,  4.23s/it]
[2024-10-21T10:35:39.672+0000] {logging_mixin.py:188} WARNING -  94%|#########4| 64/68 [04:27<00:16,  4.06s/it]
[2024-10-21T10:35:43.915+0000] {logging_mixin.py:188} WARNING -  96%|#########5| 65/68 [04:31<00:12,  4.11s/it]
[2024-10-21T10:35:47.815+0000] {logging_mixin.py:188} WARNING -  97%|#########7| 66/68 [04:35<00:08,  4.05s/it]
[2024-10-21T10:35:51.623+0000] {logging_mixin.py:188} WARNING -  99%|#########8| 67/68 [04:39<00:03,  3.98s/it]
[2024-10-21T10:35:55.155+0000] {logging_mixin.py:188} WARNING - 100%|##########| 68/68 [04:42<00:00,  3.84s/it]
[2024-10-21T10:35:55.156+0000] {logging_mixin.py:188} WARNING - 100%|##########| 68/68 [04:42<00:00,  4.16s/it]
[2024-10-21T10:35:55.180+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/components/vehicle/data_scraping_components/post_data_extraction.py", line 153, in scarpe_and_save
    upload_table_vehicle(data_table)
  File "/opt/airflow/dags/components/utils/database_table_creation.py", line 35, in upload_table_vehicle
    cur.execute(f"""
psycopg2.errors.InsufficientPrivilege: could not open file "/var/lib/postgresql/vehicle/ikman_post_data.csv" for writing: Permission denied
HINT:  COPY TO instructs the PostgreSQL server process to write a file. You may want a client-side facility such as psql's \copy.

[2024-10-21T10:35:55.195+0000] {taskinstance.py:1149} INFO - Marking task as UP_FOR_RETRY. dag_id=Vehicle_Data_scrape_Pipeline, task_id=scrape_vehicle_info_from_link, execution_date=20241021T101934, start_date=20241021T103112, end_date=20241021T103555
[2024-10-21T10:35:55.203+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 129 for task scrape_vehicle_info_from_link (could not open file "/var/lib/postgresql/vehicle/ikman_post_data.csv" for writing: Permission denied
HINT:  COPY TO instructs the PostgreSQL server process to write a file. You may want a client-side facility such as psql's \copy.
; 31601)
[2024-10-21T10:35:55.215+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-10-21T10:35:55.227+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
