[2024-10-21T10:21:00.132+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Vehicle_Data_scrape_Pipeline.scrape_vehicle_info_from_link manual__2024-10-21T10:19:34.643139+00:00 [queued]>
[2024-10-21T10:21:00.137+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Vehicle_Data_scrape_Pipeline.scrape_vehicle_info_from_link manual__2024-10-21T10:19:34.643139+00:00 [queued]>
[2024-10-21T10:21:00.138+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 4
[2024-10-21T10:21:00.147+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): scrape_vehicle_info_from_link> on 2024-10-21 10:19:34.643139+00:00
[2024-10-21T10:21:00.151+0000] {standard_task_runner.py:60} INFO - Started process 30137 to run task
[2024-10-21T10:21:00.152+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'Vehicle_Data_scrape_Pipeline', 'scrape_vehicle_info_from_link', 'manual__2024-10-21T10:19:34.643139+00:00', '--job-id', '127', '--raw', '--subdir', 'DAGS_FOLDER/vehicle_data_scraping_pipeline.py', '--cfg-path', '/tmp/tmpd5hysfap']
[2024-10-21T10:21:00.155+0000] {standard_task_runner.py:88} INFO - Job 127: Subtask scrape_vehicle_info_from_link
[2024-10-21T10:21:00.269+0000] {task_command.py:423} INFO - Running <TaskInstance: Vehicle_Data_scrape_Pipeline.scrape_vehicle_info_from_link manual__2024-10-21T10:19:34.643139+00:00 [running]> on host 988c1a0779ad
[2024-10-21T10:21:00.309+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='sdeshan' AIRFLOW_CTX_DAG_ID='Vehicle_Data_scrape_Pipeline' AIRFLOW_CTX_TASK_ID='scrape_vehicle_info_from_link' AIRFLOW_CTX_EXECUTION_DATE='2024-10-21T10:19:34.643139+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-10-21T10:19:34.643139+00:00'
[2024-10-21T10:21:00.316+0000] {logging_mixin.py:188} WARNING -   0%|          | 0/68 [00:00<?, ?it/s]
[2024-10-21T10:21:04.582+0000] {logging_mixin.py:188} WARNING -   1%|1         | 1/68 [00:04<04:45,  4.27s/it]
[2024-10-21T10:21:10.634+0000] {logging_mixin.py:188} WARNING -   3%|2         | 2/68 [00:10<05:50,  5.32s/it]
[2024-10-21T10:21:14.449+0000] {logging_mixin.py:188} WARNING -   4%|4         | 3/68 [00:14<05:01,  4.63s/it]
[2024-10-21T10:21:17.810+0000] {logging_mixin.py:188} WARNING -   6%|5         | 4/68 [00:17<04:24,  4.13s/it]
[2024-10-21T10:21:21.537+0000] {logging_mixin.py:188} WARNING -   7%|7         | 5/68 [00:21<04:11,  3.98s/it]
[2024-10-21T10:21:25.154+0000] {logging_mixin.py:188} WARNING -   9%|8         | 6/68 [00:24<03:59,  3.86s/it]
[2024-10-21T10:21:28.559+0000] {logging_mixin.py:188} WARNING -  10%|#         | 7/68 [00:28<03:46,  3.71s/it]
[2024-10-21T10:21:33.250+0000] {logging_mixin.py:188} WARNING -  12%|#1        | 8/68 [00:32<04:01,  4.02s/it]
[2024-10-21T10:21:37.416+0000] {logging_mixin.py:188} WARNING -  13%|#3        | 9/68 [00:37<03:59,  4.07s/it]
[2024-10-21T10:21:40.986+0000] {logging_mixin.py:188} WARNING -  15%|#4        | 10/68 [00:40<03:47,  3.91s/it]
[2024-10-21T10:21:44.851+0000] {logging_mixin.py:188} WARNING -  16%|#6        | 11/68 [00:44<03:42,  3.90s/it]
[2024-10-21T10:21:49.037+0000] {logging_mixin.py:188} WARNING -  18%|#7        | 12/68 [00:48<03:43,  3.99s/it]
[2024-10-21T10:21:53.191+0000] {logging_mixin.py:188} WARNING -  19%|#9        | 13/68 [00:52<03:42,  4.04s/it]
[2024-10-21T10:21:57.673+0000] {logging_mixin.py:188} WARNING -  21%|##        | 14/68 [00:57<03:45,  4.17s/it]
[2024-10-21T10:22:01.059+0000] {logging_mixin.py:188} WARNING -  22%|##2       | 15/68 [01:00<03:28,  3.93s/it]
[2024-10-21T10:22:04.840+0000] {logging_mixin.py:188} WARNING -  24%|##3       | 16/68 [01:04<03:22,  3.89s/it]
[2024-10-21T10:22:08.355+0000] {logging_mixin.py:188} WARNING -  25%|##5       | 17/68 [01:08<03:12,  3.78s/it]
[2024-10-21T10:22:12.131+0000] {logging_mixin.py:188} WARNING -  26%|##6       | 18/68 [01:11<03:08,  3.78s/it]
[2024-10-21T10:22:15.815+0000] {logging_mixin.py:188} WARNING -  28%|##7       | 19/68 [01:15<03:03,  3.75s/it]
[2024-10-21T10:22:20.481+0000] {logging_mixin.py:188} WARNING -  29%|##9       | 20/68 [01:20<03:13,  4.02s/it]
[2024-10-21T10:22:24.134+0000] {logging_mixin.py:188} WARNING -  31%|###       | 21/68 [01:23<03:03,  3.91s/it]
[2024-10-21T10:22:27.556+0000] {logging_mixin.py:188} WARNING -  32%|###2      | 22/68 [01:27<02:53,  3.77s/it]
[2024-10-21T10:22:31.232+0000] {logging_mixin.py:188} WARNING -  34%|###3      | 23/68 [01:30<02:48,  3.74s/it]
[2024-10-21T10:22:35.288+0000] {logging_mixin.py:188} WARNING -  35%|###5      | 24/68 [01:34<02:48,  3.83s/it]
[2024-10-21T10:22:39.190+0000] {logging_mixin.py:188} WARNING -  37%|###6      | 25/68 [01:38<02:45,  3.85s/it]
[2024-10-21T10:22:42.944+0000] {logging_mixin.py:188} WARNING -  38%|###8      | 26/68 [01:42<02:40,  3.82s/it]
[2024-10-21T10:22:47.681+0000] {logging_mixin.py:188} WARNING -  40%|###9      | 27/68 [01:47<02:48,  4.10s/it]
[2024-10-21T10:22:51.476+0000] {logging_mixin.py:188} WARNING -  41%|####1     | 28/68 [01:51<02:40,  4.01s/it]
[2024-10-21T10:22:55.251+0000] {logging_mixin.py:188} WARNING -  43%|####2     | 29/68 [01:54<02:33,  3.94s/it]
[2024-10-21T10:23:00.593+0000] {logging_mixin.py:188} WARNING -  44%|####4     | 30/68 [02:00<02:45,  4.36s/it]
[2024-10-21T10:23:04.437+0000] {logging_mixin.py:188} WARNING -  46%|####5     | 31/68 [02:04<02:35,  4.20s/it]
[2024-10-21T10:23:08.597+0000] {logging_mixin.py:188} WARNING -  47%|####7     | 32/68 [02:08<02:30,  4.19s/it]
[2024-10-21T10:23:12.295+0000] {logging_mixin.py:188} WARNING -  49%|####8     | 33/68 [02:11<02:21,  4.04s/it]
[2024-10-21T10:23:16.513+0000] {logging_mixin.py:188} WARNING -  50%|#####     | 34/68 [02:16<02:19,  4.10s/it]
[2024-10-21T10:23:20.136+0000] {logging_mixin.py:188} WARNING -  51%|#####1    | 35/68 [02:19<02:10,  3.95s/it]
[2024-10-21T10:23:24.291+0000] {logging_mixin.py:188} WARNING -  53%|#####2    | 36/68 [02:23<02:08,  4.01s/it]
[2024-10-21T10:23:28.370+0000] {logging_mixin.py:188} WARNING -  54%|#####4    | 37/68 [02:28<02:05,  4.03s/it]
[2024-10-21T10:23:32.129+0000] {logging_mixin.py:188} WARNING -  56%|#####5    | 38/68 [02:31<01:58,  3.95s/it]
[2024-10-21T10:23:35.569+0000] {logging_mixin.py:188} WARNING -  57%|#####7    | 39/68 [02:35<01:50,  3.80s/it]
[2024-10-21T10:23:40.159+0000] {logging_mixin.py:188} WARNING -  59%|#####8    | 40/68 [02:39<01:52,  4.04s/it]
[2024-10-21T10:23:44.774+0000] {logging_mixin.py:188} WARNING -  60%|######    | 41/68 [02:44<01:53,  4.21s/it]
[2024-10-21T10:23:48.463+0000] {logging_mixin.py:188} WARNING -  62%|######1   | 42/68 [02:48<01:45,  4.05s/it]
[2024-10-21T10:23:51.834+0000] {logging_mixin.py:188} WARNING -  63%|######3   | 43/68 [02:51<01:36,  3.85s/it]
[2024-10-21T10:23:55.650+0000] {logging_mixin.py:188} WARNING -  65%|######4   | 44/68 [02:55<01:32,  3.84s/it]
[2024-10-21T10:23:59.317+0000] {logging_mixin.py:188} WARNING -  66%|######6   | 45/68 [02:59<01:27,  3.79s/it]
[2024-10-21T10:24:02.697+0000] {logging_mixin.py:188} WARNING -  68%|######7   | 46/68 [03:02<01:20,  3.67s/it]
[2024-10-21T10:24:06.613+0000] {logging_mixin.py:188} WARNING -  69%|######9   | 47/68 [03:06<01:18,  3.74s/it]
[2024-10-21T10:24:10.133+0000] {logging_mixin.py:188} WARNING -  71%|#######   | 48/68 [03:09<01:13,  3.67s/it]
[2024-10-21T10:24:14.197+0000] {logging_mixin.py:188} WARNING -  72%|#######2  | 49/68 [03:13<01:12,  3.79s/it]
[2024-10-21T10:24:17.953+0000] {logging_mixin.py:188} WARNING -  74%|#######3  | 50/68 [03:17<01:08,  3.78s/it]
[2024-10-21T10:24:26.212+0000] {logging_mixin.py:188} WARNING -  75%|#######5  | 51/68 [03:25<01:27,  5.12s/it]
[2024-10-21T10:24:31.153+0000] {logging_mixin.py:188} WARNING -  76%|#######6  | 52/68 [03:30<01:21,  5.07s/it]
[2024-10-21T10:24:34.912+0000] {logging_mixin.py:188} WARNING -  78%|#######7  | 53/68 [03:34<01:10,  4.68s/it]
[2024-10-21T10:24:38.715+0000] {logging_mixin.py:188} WARNING -  79%|#######9  | 54/68 [03:38<01:01,  4.41s/it]
[2024-10-21T10:24:42.927+0000] {logging_mixin.py:188} WARNING -  81%|########  | 55/68 [03:42<00:56,  4.35s/it]
[2024-10-21T10:24:48.548+0000] {logging_mixin.py:188} WARNING -  82%|########2 | 56/68 [03:48<00:56,  4.73s/it]
[2024-10-21T10:24:52.435+0000] {logging_mixin.py:188} WARNING -  84%|########3 | 57/68 [03:52<00:49,  4.48s/it]
[2024-10-21T10:24:56.437+0000] {logging_mixin.py:188} WARNING -  85%|########5 | 58/68 [03:56<00:43,  4.34s/it]
[2024-10-21T10:25:00.224+0000] {logging_mixin.py:188} WARNING -  87%|########6 | 59/68 [03:59<00:37,  4.17s/it]
[2024-10-21T10:25:04.053+0000] {logging_mixin.py:188} WARNING -  88%|########8 | 60/68 [04:03<00:32,  4.07s/it]
[2024-10-21T10:25:08.871+0000] {logging_mixin.py:188} WARNING -  90%|########9 | 61/68 [04:08<00:30,  4.29s/it]
[2024-10-21T10:25:13.968+0000] {logging_mixin.py:188} WARNING -  91%|#########1| 62/68 [04:13<00:27,  4.53s/it]
[2024-10-21T10:25:17.658+0000] {logging_mixin.py:188} WARNING -  93%|#########2| 63/68 [04:17<00:21,  4.28s/it]
[2024-10-21T10:25:21.254+0000] {logging_mixin.py:188} WARNING -  94%|#########4| 64/68 [04:20<00:16,  4.08s/it]
[2024-10-21T10:25:24.882+0000] {logging_mixin.py:188} WARNING -  96%|#########5| 65/68 [04:24<00:11,  3.94s/it]
[2024-10-21T10:25:28.686+0000] {logging_mixin.py:188} WARNING -  97%|#########7| 66/68 [04:28<00:07,  3.90s/it]
[2024-10-21T10:25:33.154+0000] {logging_mixin.py:188} WARNING -  99%|#########8| 67/68 [04:32<00:04,  4.07s/it]
[2024-10-21T10:25:36.645+0000] {logging_mixin.py:188} WARNING - 100%|##########| 68/68 [04:36<00:00,  3.90s/it]
[2024-10-21T10:25:36.646+0000] {logging_mixin.py:188} WARNING - 100%|##########| 68/68 [04:36<00:00,  4.06s/it]
[2024-10-21T10:25:36.676+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/components/vehicle/data_scraping_components/post_data_extraction.py", line 153, in scarpe_and_save
    upload_table_vehicle(data_table)
  File "/opt/airflow/dags/components/utils/database_table_creation.py", line 35, in upload_table_vehicle
    cur.execute(f"""
psycopg2.errors.InsufficientPrivilege: could not open file "/var/lib/postgresql/vehicle/ikman_post_data.csv" for writing: Permission denied
HINT:  COPY TO instructs the PostgreSQL server process to write a file. You may want a client-side facility such as psql's \copy.

[2024-10-21T10:25:36.691+0000] {taskinstance.py:1149} INFO - Marking task as UP_FOR_RETRY. dag_id=Vehicle_Data_scrape_Pipeline, task_id=scrape_vehicle_info_from_link, execution_date=20241021T101934, start_date=20241021T102100, end_date=20241021T102536
[2024-10-21T10:25:36.699+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 127 for task scrape_vehicle_info_from_link (could not open file "/var/lib/postgresql/vehicle/ikman_post_data.csv" for writing: Permission denied
HINT:  COPY TO instructs the PostgreSQL server process to write a file. You may want a client-side facility such as psql's \copy.
; 30137)
[2024-10-21T10:25:36.738+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-10-21T10:25:36.753+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
